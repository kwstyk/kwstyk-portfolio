---
import Layout from '@/layouts/Layout.astro'
import ProofHero from '@/components/organisms/ProofHero.astro'
import ProofMetaCard from '@/components/organisms/ProofMetaCard.astro'
import SectionNav from '@/components/organisms/SectionNav.astro'

/**
 * Props: Proof詳細ページで使用されるメタ情報
 */
interface Props {
  title:       string
  description?: string
  difficulty?: 'easy' | 'medium' | 'hard' | 'expert'
  repro:       ('docker' | 'terraform' | 'vagrant' | 'manual')[]
  stack:       string[]
  updated:     string
  ci_status?:  string
  tags?:       string[]
  class?:      string
}

// Props 分割代入（Fallbackあり）
const {
  title,
  description = '',
  difficulty,
  repro,
  stack,
  ci_status: ciStatus,
  updated,
  tags = [],
  class: className = '',
} = Astro.props as Props
---

<!-- 全体レイアウトの共通適用 -->
<Layout siteName="KWSTYK Portfolio" pageTitle={`Proof | ${title}`} class={className}>
  <main class="flex-1 px-4 sm:px-6 lg:px-8 xl:px-16 py-8">

    <!-- ✅ Heroセクション（タイトル・再現手段・難易度など） -->
    <section class="container mx-auto px-6 sm:px-10 py-20 bg-slate-700/20 rounded-2xl">
      <div class="max-w-2xl mx-auto text-center">
        <ProofHero
          title={title}
          description={description}
          difficulty={difficulty}
          repro={repro}
          stack={stack}
          ci_status={ciStatus}
        />
      </div>
    </section>

    <!-- ✅ 本文＋メタ情報セクション -->
    <section class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
      <div class="grid grid-cols-1 lg:grid-cols-[1fr,250px] gap-8">

        <!-- ▼ メイン本文：Markdownスロット -->
        <article class="prose prose-invert" lang="ja">
          <slot />
          <slot name="footer" />
        </article>

        <!-- ▼ メタ情報：更新日・タグなど -->
        <aside class="space-y-6">
          <ProofMetaCard updated={updated} tags={tags} />
        </aside>

      </div>
    </section>

  </main>

  <!-- ✅ ページ下部：他レイヤ導線ナビゲーション -->
  <SectionNav />
</Layout>
