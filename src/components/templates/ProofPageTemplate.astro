---
import Layout from '@/layouts/Layout.astro';
import ProofHero from '@/components/organisms/ProofHero.astro';
import ProofMetaCard from '@/components/organisms/ProofMetaCard.astro';

// Props 型定義
interface Props {
  title:        string;                             // ページタイトル
  difficulty?:  'easy' | 'medium' | 'hard' | 'expert'; // 難易度
  repro:        ('docker' | 'terraform' | 'vagrant' | 'manual')[]; // 再現方法
  stack:        string[];                           // 使用スタック
  updated:      string;                             // 更新日 (YYYY-MM-DD)
  ci_status?:   string;                             // CIバッジURL
  tags?:        string[];                           // タグリスト
  class?:       string;                             // 追加クラス
}

// frontmatter からのデータ受け取り
const {
  title,
  difficulty,
  repro,
  stack,
  ci_status: ciStatus,  // Frontmatter の ci_status を内部変数 ciStatus にリネーム
  updated,
  tags = [],            // タグが無ければ空配列
  class: className,     // class を className にリネーム
} = Astro.props as Props;
---

<!-- Layout で共通ヘッダー/フッターをラップ -->
<Layout siteName="KWSTYK Portfolio" pageTitle={`Proof | ${title}`} class={className}>
  <!-- メインコンテンツ領域 -->
  <section class="max-w-4xl mx-auto px-4 py-12 space-y-8">
    <!-- ProofHero: タイトル／バッジ／CIステータス -->
    <ProofHero
      title={title}
      difficulty={difficulty}
      repro={repro}
      stack={stack}
      ci_status={ciStatus}
    />

    <!-- ProofMetaCard: 更新日／タグ -->
    <ProofMetaCard updated={updated} tags={tags} />

    <!-- Markdown 本文: remark/rehype の変換結果がスロット展開される -->
    <article class="prose prose-invert mt-6" lang="ja">
      <slot />
    </article>

    <!-- フッター領域: Story リンク等を挿入可能 -->
    <slot name="footer" />
  </section>
</Layout>
