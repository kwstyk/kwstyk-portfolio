---
import type { CollectionEntry } from 'astro:content';
import { getCollection }        from 'astro:content';
import ProofPageTemplate        from '@/components/templates/ProofPageTemplate.astro';

export const prerender = true;

// ■ getStaticPaths ─────────────────────────
export async function getStaticPaths() {
  const proofs = await getCollection('proofs');
  return proofs.map((entry) => {
    // entry.id は "network-security/packet-capture"
    const segments = entry.id.split('/');
    return {
      params: { slug: segments },
      props:  { entry },
    };
  });
}

interface Props {
  entry: CollectionEntry<'proofs'>;
}

const { entry }       = Astro.props as Props;
// render() → rendered プロパティに変更
const { Content }     = entry.rendered!;
const { data }        = entry;
---

<ProofPageTemplate
  title     ={data.title}
  difficulty={data.difficulty}
  repro     ={data.repro}
  stack     ={data.stack}
  updated   ={data.updated}
  tags      ={data.tags ?? []}
  ci_status ={data.ci_status ?? ''}>
  <Content />
</ProofPageTemplate>
