# ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªæ§‹æˆä»•æ§˜æ›¸ v 2.2 â€” Complete Edition 
æ›´æ–°æ—¥ : 2025-05-04  
ä½œè€…   : kwstyk / ChatGPT (o3)

---

## 0. ã‚³ãƒ³ã‚»ãƒ—ãƒˆ & ãƒšãƒ«ã‚½ãƒŠæ·±åº¦ãƒãƒƒãƒ—

| ãƒšãƒ«ã‚½ãƒŠ | ç›®çš„ | å¯¾å¿œãƒ¬ã‚¤ãƒ¤ | æƒ³å®šæ·±åº¦ |
|----------|------|------------|---------|
| æ¡ç”¨æ‹…å½“ | ã‚¹ã‚­ãƒ«ã®ä¿¯ç°ãƒ»ä¿å®ˆæ€§ | **Landing** | 1 |
| ç¾å ´ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ | å®Ÿè£…è©³ç´°ï¼CIè¨­è¨ˆ | **Structure** | 2 |
| å­¦ç¿’è€…ï¼ˆæœªæ¥ã®è‡ªåˆ†ï¼‰ | å†ç¾ãƒ©ãƒœï¼æ¤œè¨¼ãƒ­ã‚° | **Proof** | 3 |
| ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ | å¤±æ•—è«‡ï¼æ”¹å–„å² | **Story** | 4 |

> **æ·±åº¦ 0â€‘4** : æ•°å­—ãŒå¤§ãã„ã»ã©å†…éƒ¨äº‹æƒ…ã«è¸ã¿è¾¼ã‚€ã€‚

---

## 1. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ & ãƒãƒ¼ã‚¸ãƒ§ãƒ³å›ºå®š

| ã‚«ãƒ†ã‚´ãƒª | æ¡ç”¨æŠ€è¡“ | Locked |
|----------|----------|--------|
| é™çš„ã‚µã‚¤ãƒˆ | **Astro 5.x** (`@astrojs/mdx`) | `^5.7.0` |
| UI/CSS | **Tailwind 3.4** (JIT) | `^3.4.1` |
| å‹ãƒ»Lint | TypeScriptâ€¯5.8 / ESLintâ€¯9 / Stylelintâ€¯15 / Astro Check | â€” |
| ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° | GitHub Pages (prod) / Vercel (Preview) | â€” |
| CI/CD | GitHub Actions (`ci.yml`, `deploy.yml`, `proof-ci.yml`, `nightly.yml`) | â€” |
| QAãƒ„ãƒ¼ãƒ« | LighthouseÂ CI / Trivy / lychee | latest |
| Devç’°å¢ƒ | devcontainer + Codespaces | `ubuntu-22.04` |

> **Lockfile** : `pnpm-lock.yaml` ã‚’ commit ã—ã€CI ã§ã¯ `pnpm install --frozen-lockfile`ã€‚

---

## 2. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª & Atomic è¨­è¨ˆè¦ç´„

### 2.1 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆï¼ˆvâ€¯2.2 æ™‚ç‚¹ï¼‰

```text
src/
 â”œâ”€ data/
 â”‚   â”œâ”€ categories.json          # â˜… Structure ã‚«ãƒ¼ãƒ‰å®šç¾©
 â”‚   â””â”€ stories.json            # (æ¬¡ãƒ•ã‚§ãƒ¼ã‚º) Story RSS è‡ªå‹•ç”Ÿæˆ
 â”œâ”€ content/proofs/**.mdx       # Astro Content collection
 â”œâ”€ layouts/                    # Layout å…±æœ‰
 â”‚   â””â”€ Layout.astro            # siteName / pageTitle åˆ†é›¢æ¸ˆ
 â”œâ”€ pages/
 â”‚   â”œâ”€ index.astro              # Landing
 â”‚   â”œâ”€ structure/index.astro    # ã‚«ãƒ¼ãƒ‰è‡ªå‹•ç”Ÿæˆ
 â”‚   â”œâ”€ structure/[slug].astro   # ã‚«ãƒ†ã‚´ãƒªè©³ç´° (getStaticPaths)
 â”‚   â””â”€ proof/[...slug].astro    # Proof å‹•çš„
 â”œâ”€ components/
 â”‚   â”œâ”€ atoms/
 â”‚   â”œâ”€ molecules/
 â”‚   â”œâ”€ organisms/
 â”‚   â””â”€ templates/
 â”œâ”€ styles/ (globals.css, *.css)
 â””â”€ utils/  (seo.ts ã»ã‹)
```

### 2.2 Atomic & Template ä¸€è¦§

| éšå±¤ | ãƒ•ã‚¡ã‚¤ãƒ« | ä¸»è²¬å‹™ |
|------|---------|--------|
| **Atom** | `Button.astro`, `Badge.astro`, `Heading.astro` | æœ€å°å˜ä½ UI |
| **Molecule** | `Card.astro`, `Navbar.astro`, `StackChip.astro` | å†åˆ©ç”¨ãƒ–ãƒ­ãƒƒã‚¯ |
| **Organism** | `Hero.astro`, `ProofHero.astro`, `Layout.astro` | ã‚»ã‚¯ã‚·ãƒ§ãƒ³ |
| **Template** | `LandingTemplate.astro`, `ProofPageTemplate.astro` | ãƒšãƒ¼ã‚¸éª¨æ ¼ |
| **Page** | `/pages/**` | ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å®Ÿä½“ |

> **å‘½åè¦å‰‡** : `PascalCase.astro`ã€‚åŸºæœ¬ã¯ Tailwind ç›´æ›¸ãã€è¤‡é›‘åŒ–æ™‚ã®ã¿ `.module.css`ã€‚

---

## 3. ã‚¹ã‚¿ã‚¤ãƒ« & ãƒ‡ã‚¶ã‚¤ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³åŒæœŸ

1. `globals.css` ã§ **CSS Variables** å®£è¨€ã€‚
2. `tailwind.config.mjs` â†’ `theme.extend.colors` ã«**åŒãƒˆãƒ¼ã‚¯ãƒ³å**ã§ç™»éŒ²ã€‚
3. è‰²å‚ç…§ã¯ **Tailwind â†’ CSSå¤‰æ•° â†’ ç›´æ¥ã‚³ãƒ¼ãƒ‰** ã®é †ã€‚
4. Media Query ã¯åŸºæœ¬ Tailwind ã® BPã€ç›´æ¥æ›¸ãã®ã¯ `@media (max-width: 640px)` ã®ã¿è¨±å¯ã€‚

### 3.1 ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ

| Token | HEX |
|-------|-----|
| `bg-start` | `#0d1b2a` |
| `bg-mid`   | `#162d46` |
| `bg-end`   | `#0a2540` |
| `text`     | `#e0e7ff` |
| `accent`   | `#61dafb` |
| `card-bg`  | `#112240` |
| `border`   | `#233554` |

> **Structure ãƒãƒƒã‚¸è‰²** : `categories.json` ã® `color` ã‚’ãã®ã¾ã¾ `border` / `text` ã«é©ç”¨ã€‚Tailwind safelist ã«è¿½åŠ æ¸ˆã¿ã€‚

---

## 4. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ & ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### 4.1 categories.json (Structure ç”¨)

```jsonc
[
  {
    "id": "network-security",
    "slug": "network-security",
    "title": "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£",
    "description": "å®‰å…¨ãªé€šä¿¡ã¨ç›£è¦–ä½“åˆ¶ã‚’ç¢ºç«‹ã™ã‚‹ãŸã‚ã®å®Ÿè·µ",
    "icon": "ğŸ›¡ï¸",
    "badge": "published",
    "color": "#00C8FF"
  },
  â€¦
]
```

### 4.2 Proof Frontâ€‘matter (v4.3, å¤‰æ›´ãªã—)

```yaml
---
slug: "network-security/packet-capture"
difficulty: easy           # easy|medium|hard|expert
repro: ["docker"]
stack: ["docker","tcpdump"]
updated: 2025-05-01
tags: ["pcap","wireshark"]
ci_status: "https://â€¦/badge.svg"
stories: ["zenn-123"]          # Storyé€£æºç”¨ (optional)
---
```

### 4.3 Zod ã‚¹ã‚­ãƒ¼ãƒ (æŠœç²‹)

```ts
export const CategorySchema = z.object({
  id: z.string(),
  slug: z.string(),
  title: z.string(),
  description: z.string(),
  icon: z.string().max(2), // çµµæ–‡å­— 1 æ–‡å­—
  badge: z.string(),
  color: z.string().regex(/^#/),
});
```

CI ã§ `CategorySchema.parse`ã€`ProofSchema.parse` ã‚’æ¤œè¨¼ã—å‹å´©ã‚Œã‚’é˜²æ­¢ã€‚

---

## 5. Layout ãƒ‘ã‚¿ãƒ¼ãƒ³

`Layout.astro` ã¯ä»¥ä¸‹ã® Props ã‚’æŒã¤ï¼š

```ts
interface LayoutProps {
  siteName?: string;   // ãƒ˜ãƒƒãƒ€ãƒ¼å·¦ã®ãƒ­ã‚´æ–‡å­—åˆ—
  pageTitle?: string;  // <title> ã«ä½¿ã† SEO ç”¨æ–‡å­—åˆ—
  class?: string;      // main ã‚¿ã‚°è¿½åŠ ã‚¯ãƒ©ã‚¹
}
```

```astro
<Layout
  siteName="KWSTYK Portfolio"
  pageTitle={`Structure | ${category.title}`}
>
```

---

## 6. ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

| ã‚³ãƒãƒ³ãƒ‰ | å†…å®¹ |
|----------|------|
| `pnpm dev` | é–‹ç™ºã‚µãƒ¼ãƒ (`http://localhost:4321`) |
| `pnpm lint` | ESLint + Stylelint |
| `pnpm typecheck` | `tsc --noEmit` + `astro check` |
| `pnpm build` | é™çš„ãƒ“ãƒ«ãƒ‰ (`dist/`) |
| `pnpm just up <proof>` | Proof å†ç¾ãƒ©ãƒœã‚’ Docker/Vagrant ç­‰ã§èµ·å‹• |


---

## 7. Git & PR ãƒ«ãƒ¼ãƒ«

| é …ç›® | è¦ç´„ |
|------|------|
| ãƒ–ãƒ©ãƒ³ãƒ   | `feat/*` `fix/*` `refactor/*` `ci/*` |
| Commit    | Conventional Commits (`feat(structure): â€¦`) |
| SquashPR  | 1 PR = 1 Commit (Squash & Merge) |
| Issues    | `/docs/.github/ISSUE_TEMPLATE` ä½¿ç”¨ |

---

## 8. CI / Quality Gate

### 8.1 Workflow ä¸€è¦§

| workflow | ãƒˆãƒªã‚¬ | ä¸»å‡¦ç† |
|----------|-------|--------|
| `ci.yml` | push/PR | lint â†’ typecheck â†’ build |
| `proof-ci.yml` | paths-filter `proofs/**` | Proof å†ç¾, Trivy |
| `nightly.yml` | cron 3:00 JST | Lighthouse, dead link, SBOM |

### 8.2 é˜ˆå€¤

| æŒ‡æ¨™ | ç›®æ¨™ | å¤±æ•—æ™‚ |
|------|------|-------|
| Lint / Type error | 0 | PR Fail |
| Build error | 0 | PR
